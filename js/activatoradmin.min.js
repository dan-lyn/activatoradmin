require("text!templates/item.tpl text!templates/pagination.tpl jquery bootstrap underscore backbone backbonePaginator".split(" "),function(e,f){var d="";"undefined"!=typeof appConfig&&appConfig.hasOwnProperty("baseUrl")&&(d=appConfig.baseUrl);window.ActivatorItem=Backbone.Model.extend({urlRoot:d+"index.php/item",idAttribute:"id",initialize:function(){"undefined"!=typeof appConfig&&appConfig.hasOwnProperty("db_mapping")&&(appConfig.db_mapping.hasOwnProperty("name")&&""!=appConfig.db_mapping.name&&
this.set("name",this.get(appConfig.db_mapping.name)),appConfig.db_mapping.hasOwnProperty("isactive")&&""!=appConfig.db_mapping.isactive&&this.set("isactive",this.get(appConfig.db_mapping.isactive)),appConfig.db_mapping.hasOwnProperty("image")&&""!=appConfig.db_mapping.image&&this.set("image",this.get(appConfig.db_mapping.image)))}});window.ActivatorList=Backbone.Paginator.clientPager.extend({model:ActivatorItem,paginator_core:{type:"GET",dataType:"json",url:d+"index.php/items"},paginator_ui:{firstPage:1,
currentPage:1,perPage:10,totalPages:10},parse:function(a){return a}});var b=new ActivatorList;window.ActivatorItemView=Backbone.View.extend({tagName:"li",className:"well",template:_.template(e),events:{"click #toggle-activate":"toggleActivate","click img":"toggleImage"},initialize:function(){this.listenTo(this.model,"change",this.render)},render:function(){var a=this.model;if(""!=a.get("image")&&null!==a.get("image")&&"undefined"!=typeof appConfig&&appConfig.hasOwnProperty("imagePath")&&""!=appConfig.imagePath&&
0!==a.get("image").indexOf(d+appConfig.imagePath)){var c=d+appConfig.imagePath+a.get("image");a.set("image",c)}else if(""==a.get("image")||null===a.get("image"))c=d+"images/default.jpg",a.set("image",c);c=a.toJSON();"undefined"!=typeof appConfig&&appConfig.hasOwnProperty("show_delete")&&appConfig.show_delete?c.show_delete=appConfig.show_delete:c.show_delete=!1;this.$el.html(this.template(c));this.$el.find("input").tooltip({placement:"top"});if("undefined"!=typeof appConfig&&appConfig.hasOwnProperty("show_delete")&&
appConfig.show_delete)this.$el.find("#itemDelete-"+a.get("id")).find("#itemDeleteConfirm").on("click",function(){a.destroy({success:function(a,c){b.pager();$(".modal-backdrop").remove()}})});return this.$el},toggleActivate:function(){var a=this.$el.find("#toggle-activate").get(0).checked?1:0;this.model.save({isactive:a})},toggleImage:function(){var a=this.model.get("image"),b=this.$el.find("img").get(0).offsetTop,d=this.$el.find("img").get(0).offsetLeft;$("#background").show("fast","linear",function(){$("#container").append('<img class="img-thumbnail img-full" src="'+
a+'" style="position: absolute; top: '+b+"px; left: "+d+'px" />')});$("#background").on("click",function(){$(this).hide();$("#container").find(".img-full").remove()})}});window.ActivatorPaginationView=Backbone.View.extend({events:{"click a.first":"gotoFirst","click a.prev":"gotoPrev","click a.next":"gotoNext","click a.last":"gotoLast","click a.page":"gotoPage"},template:_.template(f),initialize:function(){b.on("reset",this.render,this)},render:function(){this.$el.html(this.template(b.info()));$("#pagination-container").append(this.$el)},
gotoFirst:function(a){a.preventDefault();b.goTo(1)},gotoPrev:function(a){a.preventDefault();b.previousPage()},gotoNext:function(a){a.preventDefault();b.nextPage()},gotoLast:function(a){a.preventDefault();b.goTo(b.information.lastPage)},gotoPage:function(a){a.preventDefault();a=$(a.target).text();b.goTo(a)}});window.ActivatorAppView=Backbone.View.extend({el:$("#container"),initialize:function(){b.on("reset",this.addItems,this);b.fetch({reset:!0,success:function(a,c){b.pager();(new ActivatorPaginationView).render()}})},
addItems:function(){$("#itemlist").empty();b.each(function(a){a=new ActivatorItemView({model:a});$("#itemlist").append(a.render())})}});new ActivatorAppView});
